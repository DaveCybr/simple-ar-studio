<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AR Experience</title>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image-aframe.prod.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
      .loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        color: white;
        font-family: system-ui, -apple-system, sans-serif;
      }
      .loading.hidden {
        display: none;
      }
      .spinner {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(255,255,255,0.3);
        border-top-color: #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      .hint {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 12px 24px;
        border-radius: 30px;
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 14px;
        z-index: 100;
        text-align: center;
        backdrop-filter: blur(10px);
      }
    </style>
  </head>
  <body>
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>Memuat AR Experience...</p>
      <p style="font-size: 12px; opacity: 0.7;">Izinkan akses kamera</p>
    </div>

    <div class="hint" id="hint">
      ðŸ“± Arahkan kamera ke marker card
    </div>

    <a-scene 
      mindar-image="imageTargetSrc: https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/examples/image-tracking/assets/card-example/card.mind; autoStart: true; uiLoading: no; uiScanning: no; uiError: no;" 
      color-space="sRGB" 
      renderer="colorManagement: true, physicallyCorrectLights" 
      vr-mode-ui="enabled: false" 
      device-orientation-permission-ui="enabled: false"
    >
      <a-assets>
        <img id="card" src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/examples/image-tracking/assets/card-example/card.png" />
        <a-asset-item id="avatarModel" src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/examples/image-tracking/assets/card-example/softmind/scene.gltf"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <!-- Card plane -->
        <a-plane 
          src="#card" 
          position="0 0 0" 
          height="0.552" 
          width="1" 
          rotation="0 0 0"
          material="transparent: true; opacity: 0.8"
        ></a-plane>
        
        <!-- 3D Model with animation -->
        <a-gltf-model 
          rotation="0 0 0" 
          position="0 0 0.1" 
          scale="0.005 0.005 0.005" 
          src="#avatarModel"
          animation="property: position; to: 0 0.1 0.1; dur: 1000; easing: easeInOutQuad; loop: true; dir: alternate"
        ></a-gltf-model>

        <!-- Additional 3D elements -->
        <a-box 
          position="-0.4 0.3 0.1" 
          scale="0.1 0.1 0.1" 
          color="#3b82f6"
          animation="property: rotation; to: 0 360 0; dur: 2000; loop: true; easing: linear"
        ></a-box>

        <a-sphere 
          position="0.4 0.3 0.1" 
          radius="0.05" 
          color="#ef4444"
          animation="property: scale; to: 1.2 1.2 1.2; dur: 500; loop: true; dir: alternate; easing: easeInOutQuad"
        ></a-sphere>

        <!-- Text -->
        <a-text 
          value="Welcome to AR!" 
          position="0 -0.35 0.05" 
          scale="0.4 0.4 0.4" 
          color="#ffffff" 
          align="center"
          animation="property: opacity; from: 0.5; to: 1; dur: 1000; loop: true; dir: alternate"
        ></a-text>
      </a-entity>
    </a-scene>

    <script>
      // Hide loading screen when AR is ready
      const sceneEl = document.querySelector('a-scene');
      const loadingEl = document.getElementById('loading');
      const hintEl = document.getElementById('hint');

      sceneEl.addEventListener('arReady', () => {
        loadingEl.classList.add('hidden');
      });

      sceneEl.addEventListener('arError', () => {
        loadingEl.innerHTML = '<p style="color: #ef4444;">Error: Tidak dapat mengakses kamera</p><p style="font-size: 12px;">Pastikan browser mendukung WebRTC</p>';
      });

      // Update hint when target found/lost
      const target = document.querySelector('[mindar-image-target]');
      target.addEventListener('targetFound', () => {
        hintEl.textContent = 'âœ… Marker terdeteksi!';
        hintEl.style.background = 'rgba(34, 197, 94, 0.9)';
      });

      target.addEventListener('targetLost', () => {
        hintEl.textContent = 'ðŸ“± Arahkan kamera ke marker card';
        hintEl.style.background = 'rgba(0,0,0,0.7)';
      });
    </script>
  </body>
</html>
